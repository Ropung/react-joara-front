(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[124],{918:function(t,e,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/publish/[bid]/episode",function(){return s(3245)}])},3245:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return m}});var r=s(5893),n=s(7935),i=s(6991),l=s(8742),o=s(5945),u=s(8228);let{BOOK_ME:a}=n.Z,c=(t,e)=>l.Vm.post("/books/".concat(t,"/episode"),e).then(t=>{let{data:e}=t;e.success?alert("에피소드가 성공적으로 등록되었습니다."):alert("중복된 제목이거나 등록에 실패했습니다. ")}).catch(console.error),h=()=>{let t=(0,o.NL)();return(0,u.D)(t=>{let{bookId:e,epiValue:s}=t;return c(e,s)},{onError:t=>alert(t),onSuccess:()=>{t.invalidateQueries([i.kJ]),t.invalidateQueries([i.T6])}})};var d=s(8993),p=s(1163),f=s(7294);let x=()=>{let t=(0,p.useRouter)(),{HOME:e}=n.Z,{bid:s}=t.query,i=(0,f.useRef)(null),[l,o]=(0,f.useState)("");(0,d.Z)(i.current,l);let[u,a]=(0,f.useState)({}),{mutate:c}=h(),x=t=>{var e,s;let r=null===(e=t.target)||void 0===e?void 0:e.value,n=null===(s=t.target)||void 0===s?void 0:s.id;a(t=>({...t,[n]:r}))},m=()=>{u.content&&u.quote&&u.epiTitle&&c({bookId:Number(s),epiValue:u},{onSuccess:()=>{t.push(e)},onError:t=>{alert(t)}})};return(0,r.jsx)("div",{className:"flex items-center justify-center w-full p-8",children:(0,r.jsxs)("section",{className:"w-[90%] flex flex-col gap-4 bg-white rounded-md p-8 shadow-md",children:[(0,r.jsxs)("section",{className:"flex flex-row items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"에피소드 등록"}),(0,r.jsx)("button",{className:"px-6 py-4 font-bold border shadow-md rounded-xl hover:text-main-contra hover:bg-main",onClick:m,children:"에피소드 등록하기"})]}),(0,r.jsxs)("section",{className:"flex flex-col w-full gap-4",children:[(0,r.jsxs)("div",{className:"w-full flex flex-row justify-center items-center border border-gray-400 rounded-md shadow-md p-4 gap-6",children:[(0,r.jsx)("p",{className:"px-4 font-bold",children:"제목"}),(0,r.jsx)("input",{id:"epiTitle",type:"text",className:"flex flex-1 px-4 py-2 border border-gray-400 rounded-lg",placeholder:"50자 이하로 작성 가능합니다.",maxLength:50,onChange:t=>x(t)})]}),(0,r.jsx)("div",{className:"w-full h-full flex flex-row justify-center items-center border border-gray-400 rounded-md shadow-md p-4 gap-6",children:(0,r.jsx)("textarea",{ref:i,className:"w-full min-h-[15vh] flex flex-1  px-4 py-2 outline-none resize-none placeholder:text-base",rows:1,placeholder:"작품 줄거리를 입력하세요.",maxLength:200,onChange:t=>x(t),id:"content"})}),(0,r.jsxs)("div",{className:"w-full h-full flex flex-col justify-center items-start border border-gray-400 rounded-md shadow-md p-4",children:[(0,r.jsx)("p",{className:"text-xl font-bold",children:"작가 한마디"}),(0,r.jsx)("textarea",{id:"quote",className:"w-full min-h-[10vh] flex flex-1  px-4 py-2 outline-none resize-none placeholder:text-base",rows:1,placeholder:"작가의 한마디....",onChange:t=>x(t)})]})]}),(0,r.jsx)("button",{className:"px-6 py-4 font-bold border shadow-md rounded-xl hover:text-main-contra bg-main text-main-contra hover:bg-black",onClick:m,children:"등록하기"})]})})};var m=x},8993:function(t,e,s){"use strict";var r=s(7294);let n=(t,e)=>{(0,r.useEffect)(()=>{if(t){t.style.height="0px";let e=t.scrollHeight;t.style.height=e+"px"}},[t,e])};e.Z=n},8228:function(t,e,s){"use strict";s.d(e,{D:function(){return d}});var r=s(7294),n=s(464),i=s(2161),l=s(9886),o=s(81),u=s(3989);class a extends u.l{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;let s=this.options;this.options=this.client.defaultMutationOptions(t),(0,i.VS)(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(e=this.currentMutation)||e.setOptions(this.options)}onUnsubscribe(){if(!this.listeners.length){var t;null==(t=this.currentMutation)||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();let e={listeners:!0};"success"===t.type?e.onSuccess=!0:"error"===t.type&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:void 0!==t?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){let t=this.currentMutation?this.currentMutation.state:(0,l.R)(),e={...t,isLoading:"loading"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset};this.currentResult=e}notify(t){o.V.batch(()=>{if(this.mutateOptions&&this.hasListeners()){var e,s,r,n,i,l,o,u;t.onSuccess?(null==(e=(s=this.mutateOptions).onSuccess)||e.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(r=(n=this.mutateOptions).onSettled)||r.call(n,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)):t.onError&&(null==(i=(l=this.mutateOptions).onError)||i.call(l,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(o=(u=this.mutateOptions).onSettled)||o.call(u,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context))}t.listeners&&this.listeners.forEach(t=>{t(this.currentResult)})})}}var c=s(5945),h=s(4798);function d(t,e,s){let l=(0,i.lV)(t,e,s),u=(0,c.NL)({context:l.context}),[d]=r.useState(()=>new a(u,l));r.useEffect(()=>{d.setOptions(l)},[d,l]);let f=(0,n.$)(r.useCallback(t=>d.subscribe(o.V.batchCalls(t)),[d]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),x=r.useCallback((t,e)=>{d.mutate(t,e).catch(p)},[d]);if(f.error&&(0,h.L)(d.options.useErrorBoundary,[f.error]))throw f.error;return{...f,mutate:x,mutateAsync:f.mutate}}function p(){}}},function(t){t.O(0,[774,888,179],function(){return t(t.s=918)}),_N_E=t.O()}]);